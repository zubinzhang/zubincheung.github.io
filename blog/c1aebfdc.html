<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>golang函数参数传递详解 | Zubin | Later Equals Never</title>

  
  <meta name="author" content="Zubin">
  

  
  <meta name="description" content="参数传递是指在程序的传递过程中，实际参数就会将参数值传递给相应的形式参数，然后在函数中实现对数据处理和返回的过程。比较常见的参数传递有：值传递、指针传递、引用传递。">
  

  
  
  <meta name="keywords" content="golang">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="golang函数参数传递详解"/>

  <meta property="og:site_name" content="Zubin"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Zubin" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Zubin</a>
    </h1>
    <p class="site-description">Later Equals Never</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>golang函数参数传递详解</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/c1aebfdc.html" rel="bookmark">
        <time class="entry-date published" datetime="2018-06-13T03:53:53.000Z">
          2018-06-13
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>参数传递是指在程序的传递过程中，实际参数就会将参数值传递给相应的形式参数，然后在函数中实现对数据处理和返回的过程。比较常见的参数传递有：值传递、指针传递、引用传递。</p>
<span id="more"></span>

<p>一直以为 Go 里面函数传参有值传递和引用传递两种方式，对指针传递和引用传递的区别也不是很清楚，查看了下官方文档才发现并不是这么回事。</p>
<blockquote>
<p>In a function call, the function value and arguments are evaluated in the usual order. After they are evaluated, the parameters of the call are passed by value to the function and the called function begins execution.</p>
</blockquote>
<p>文档地址：<a target="_blank" rel="noopener" href="https://golang.org/ref/spec#Calls">https://golang.org/ref/spec#Calls</a><br>或者：<a target="_blank" rel="noopener" href="http://docs.studygolang.com/ref/spec#Calls">http://docs.studygolang.com/ref/spec#Calls</a></p>
<p>官方文档已经明确说明：<strong>Go 里边函数传参只有值传递一种方式</strong>，为了加强自己的理解，再把每种传参方式进行一次梳理。</p>
<h2 id="值传递"><a href="#值传递" class="headerlink" title="值传递"></a>值传递</h2><blockquote>
<p>值传递是指在调用函数时将实际参数复制一份传递到函数中，这样在函数中如果对参数进行修改，将不会影响到实际参数。</p>
</blockquote>
<p>运行以下代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">inc</span><span class="params">(x <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;x 内存地址:%p 值:%d \n&quot;</span>, &amp;x, x)</span><br><span class="line">	x++</span><br><span class="line">	fmt.Printf(<span class="string">&quot;x:%d \n&quot;</span>, x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">&quot;a 内存地址:%p 值:%d \n&quot;</span>, &amp;a, a)</span><br><span class="line">	inc(a)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;执行后 a:%d \n&quot;</span>, a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果为：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a 内存地址:<span class="number">0</span>xc<span class="number">42008c008</span> 值:<span class="number">1</span></span><br><span class="line">x 内存地址:<span class="number">0</span>xc<span class="number">42008c018</span> 值:<span class="number">1</span></span><br><span class="line">x:<span class="number">2</span></span><br><span class="line">执行后 a:<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>可以看出程序中使用的是值传递，形参 x 是实参 a 在栈上的一份拷贝， 和实参拥有两个完全不同的地址，在函数内部改变了 x 的值，a 并没有改变</p>
<h2 id="指针传递"><a href="#指针传递" class="headerlink" title="指针传递"></a>指针传递</h2><blockquote>
<p>形参为指向实参地址的指针，当对形参的指向操作时，就相当于对实参本身进行的操作。</p>
</blockquote>
<p>修改上面代码</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">inc</span><span class="params">(x *<span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;x 内存地址:%p 值:%p \n&quot;</span>, &amp;x, x)</span><br><span class="line">	*x++</span><br><span class="line">	fmt.Printf(<span class="string">&quot;x:%d \n&quot;</span>, *x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">&quot;a 内存地址:%p 值:%d \n&quot;</span>, &amp;a, a)</span><br><span class="line">	inc(&amp;a)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;执行后 a:%d \n&quot;</span>, a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果为：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a 内存地址:<span class="number">0</span>xc<span class="number">42008c008</span> 值:<span class="number">1</span></span><br><span class="line">x 内存地址:<span class="number">0</span>xc<span class="number">4200a0020</span> 值:<span class="number">0</span>xc<span class="number">42008c008</span></span><br><span class="line">x:<span class="number">2</span></span><br><span class="line">执行后 a:<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>可以看到指针&amp;a 传给函数的形参 x 后，形参将会是它在栈上的一份拷贝，他们本身将各自拥有不同的地址，但是二者的值是一样的（都是变量 a 的地址），因此可以通过指针相关的操作来改变 a 的值。</p>
<h2 id="引用传递"><a href="#引用传递" class="headerlink" title="引用传递"></a>引用传递</h2><blockquote>
<p>引用传递是指在调用函数时将实际参数的地址传递到函数中，那么在函数中对参数所进行的修改，将影响到实际参数</p>
</blockquote>
<p>由于 Go 中并不存在引用传递，我们看下一段 c++代码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">inc</span><span class="params">( <span class="type">int</span>&amp; x)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x 内存地址:%p 值:%d \n&quot;</span>, &amp;x, x);</span><br><span class="line">    x++;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x:%d \n&quot;</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> * argv[])</span> </span>&#123;</span><br><span class="line">    <span class="comment">// insert code here...</span></span><br><span class="line">    <span class="type">int</span> a=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a 内存地址:%p 值:%d \n&quot;</span>, &amp;a, a);</span><br><span class="line">    <span class="built_in">inc</span>(a);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;执行后 a:%d \n&quot;</span>, a);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> 内存地址:<span class="number">0</span><span class="selector-tag">x7ffeefbff57c</span> 值:<span class="number">1</span></span><br><span class="line"><span class="selector-tag">x</span> 内存地址:<span class="number">0</span><span class="selector-tag">x7ffeefbff57c</span> 值:<span class="number">1</span></span><br><span class="line"><span class="selector-tag">x</span>:<span class="number">2</span></span><br><span class="line">执行后 <span class="selector-tag">a</span>:<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>可以看到引用传递，操作地址就是实参地址 ，只是相当于实参的一个别名，对它的操作就是对实参的操作</p>
<p>那么传 slice 是不是传引用呢？执行下面代码</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">change</span><span class="params">(x []<span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;\nx: %#v x内存地址:%p \n&quot;</span>, x, &amp;x)</span><br><span class="line">	<span class="keyword">for</span> i, _ := <span class="keyword">range</span> x &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;x[%d]内存地址：%p\n&quot;</span>, i, &amp;x[i])</span><br><span class="line">	&#125;</span><br><span class="line">	x[<span class="number">1</span>] = <span class="number">8</span></span><br><span class="line">	fmt.Printf(<span class="string">&quot;\n执行后 x:%#v \n&quot;</span>, x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := []<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">&quot;a: %#v a内存地址:%p \n&quot;</span>, a, &amp;a)</span><br><span class="line">	<span class="keyword">for</span> i, _ := <span class="keyword">range</span> a &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;a[%d]内存地址：%p\n&quot;</span>, i, &amp;a[i])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	change(a)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">&quot;\n执行后 a:%#v \n&quot;</span>, a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果为：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span>: <span class="selector-attr">[]</span>int&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125; a内存地址:<span class="number">0</span>xc42000a0c0</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-attr">[0]</span>内存地址：<span class="number">0</span>xc4200182c0</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-attr">[1]</span>内存地址：<span class="number">0</span>xc4200182c8</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-attr">[2]</span>内存地址：<span class="number">0</span>xc4200182d0</span><br><span class="line"></span><br><span class="line">x: <span class="selector-attr">[]</span>int&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125; x内存地址:<span class="number">0</span>xc42000a100</span><br><span class="line">x<span class="selector-attr">[0]</span>内存地址：<span class="number">0</span>xc4200182c0</span><br><span class="line">x<span class="selector-attr">[1]</span>内存地址：<span class="number">0</span>xc4200182c8</span><br><span class="line">x<span class="selector-attr">[2]</span>内存地址：<span class="number">0</span>xc4200182d0</span><br><span class="line"></span><br><span class="line">执行后 x:<span class="selector-attr">[]</span>int&#123;<span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line">执行后 <span class="selector-tag">a</span>:<span class="selector-attr">[]</span>int&#123;<span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure>

<p>可以看出形参和实参拥有不同的地址，但是它们存储的地址是一样的，这也是能够进行修改的原因，所以说<strong>传 slice 不是传引用*<br>显而易见</strong>Go 里边函数传参只有值传递一种方式**, 包括 slice&#x2F;map&#x2F;chan 在内所有类型, 没有传引用的说法.</p>
<p><a target="_blank" rel="noopener" href="https://github.com/zubincheung/go-func-transfer">完整代码</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/后端/">后端</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/golang/">golang</a>
    </span>
    

    </div>

    
  </div>
</article>

  






    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2022 Zubin
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>