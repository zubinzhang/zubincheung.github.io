<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>CPU使用率 | Zubin | Later Equals Never</title>

  
  <meta name="author" content="Zubin">
  

  
  <meta name="description" content="什么是 CPU 使用率CPU 使用率就是除了空闲时间外的其他时间占总 CPU 时间的百分比
事实上，为了计算 CPU 使用率，性能工具一般都会取间隔一段时间（比如 3 秒）的两次值，作差后，再计算出这段时间内的平均 CPU 使用率，即
需要注意的是，**&amp;gt;性能分析工具给出的都是间隔一段时间的平">
  

  
  
  <meta name="keywords" content="学习笔记,Linux">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="CPU使用率"/>

  <meta property="og:site_name" content="Zubin"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Zubin" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Zubin</a>
    </h1>
    <p class="site-description">Later Equals Never</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>CPU使用率</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/blog/3ad6e1fc.html" rel="bookmark">
        <time class="entry-date published" datetime="2018-12-21T09:14:16.000Z">
          2018-12-21
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h3 id="什么是-CPU-使用率"><a href="#什么是-CPU-使用率" class="headerlink" title="什么是 CPU 使用率"></a>什么是 CPU 使用率</h3><p><strong>CPU 使用率</strong>就是除了空闲时间外的其他时间占总 CPU 时间的百分比<br><img src="https://github.com/zubincheung/blog-images/blob/master/2018/3edcc7f908c7c1ddba4bbcccc0277c09.png?raw=true"></p>
<p>事实上，为了计算 CPU 使用率，性能工具一般都会取间隔一段时间（比如 3 秒）的两次值，作差后，再计算出这段时间内的平均 CPU 使用率，即<br><img src="https://github.com/zubincheung/blog-images/blob/master/2018/8408bb45922afb2db09629a9a7eb1d5a.png?raw=true"></p>
<p>需要注意的是，**&gt;性能分析工具给出的都是间隔一段时间的平均 CPU 使用率，所以要注意间隔时间的设置**，特别是用多个工具对比分析时，你一定要保证它们用的是相同的间隔时间。</p>
<h3 id="怎么查看-CPU-使用率"><a href="#怎么查看-CPU-使用率" class="headerlink" title="怎么查看 CPU 使用率"></a>怎么查看 CPU 使用率</h3><ul>
<li>top 显示了系统总体的 CPU 和内存使用情况，以及各个进程的资源使用情况。<ul>
<li>系统的 CPU 使用率(%Cpu)</li>
</ul>
</li>
<li>pidstat 专门分析每个进程 CPU 使用情况的工具<ul>
<li>用户态 CPU 使用率 （%usr）；</li>
<li>内核态 CPU 使用率（%system）；</li>
<li>运行虚拟机 CPU 使用率（%guest）；</li>
<li>等待 CPU 使用率（%wait）；</li>
<li>以及总的 CPU 使用率（%CPU）。</li>
</ul>
</li>
<li>perf 分析 CPU 性能问题</li>
<li>pstree 用树状形式显示所有进程之间的关系,可以用来查找一个进程的父进程</li>
<li>execsnoop 专为短时进程设计的工具</li>
</ul>
<h3 id="CPU-使用率过高怎么办？"><a href="#CPU-使用率过高怎么办？" class="headerlink" title="CPU 使用率过高怎么办？"></a>CPU 使用率过高怎么办？</h3><ul>
<li><p>CPU 使用率是最直观和最常用的系统性能指标，更是我们在排查性能问题时，通常会关注的第一个指标。所以我们更要熟悉它的含义，尤其要弄清楚用户（%user）、Nice（%nice）、系统（%system） 、等待 I&#x2F;O（%iowait） 、中断（%irq）以及软中断（%softirq）这几种不同 CPU 的使用率。比如说：</p>
<ul>
<li>用户 CPU 和 Nice CPU 高，说明用户态进程占用了较多的 CPU，所以应该着重排查进程的性能问题。</li>
<li>系统 CPU 高，说明内核态占用了较多的 CPU，所以应该着重排查内核线程或者系统调用的性能问题。</li>
<li>I&#x2F;O 等待 CPU 高，说明等待 I&#x2F;O 的时间比较长，所以应该着重排查系统存储是不是出现了 I&#x2F;O 问题。</li>
<li>软中断和硬中断高，说明软中断或硬中断的处理程序占用了较多的 CPU，所以应该着重排查内核中的中断服务程序。</li>
</ul>
</li>
<li><p>碰到 CPU 使用率升高的问题，你可以借助 top、pidstat 等工具，确认引发 CPU 性能问题的来源；再使用 perf 等工具，排查出引起性能问题的具体函数。</p>
</li>
<li><p>碰到常规问题无法解释的 CPU 使用率情况时，首先要想到有可能是短时应用导致的问题，比如有可能是下面这两种情况。</p>
<ul>
<li>应用里直接调用了其他二进制程序，这些程序通常运行时间比较短，通过 top 等工具也不容易发现</li>
<li>应用本身在不停地崩溃重启，而启动过程的资源初始化，很可能会占用相当多的 CPU</li>
</ul>
</li>
</ul>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Linux/">Linux</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/学习笔记/">学习笔记</a><a href="/tags/Linux/">Linux</a>
    </span>
    

    </div>

    
  </div>
</article>

  






    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2022 Zubin
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>